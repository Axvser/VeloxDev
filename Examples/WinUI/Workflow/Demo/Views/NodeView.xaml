<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="Demo.Views.NodeView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Demo.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:Demo.ViewModels"
    d:DataContext="{d:DesignInstance Type=viewmodels:NodeViewModel}"
    mc:Ignorable="d">

    <Grid Background="Transparent">
        <Border Background="#1e1e1e"
                VerticalAlignment="Top"               
                ManipulationMode="TranslateX,TranslateY"
                ManipulationStarted="OnManipulationStarted"
                ManipulationDelta="OnManipulationDelta"
                ManipulationCompleted="OnManipulationCompleted">
            <TextBlock x:Name="TitleText"
                   Text="{Binding Name}"
                   Foreground="White"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"/>
        </Border>
        <Border BorderThickness="1"
                CornerRadius="5"
                BorderBrush="#1e1e1e">
            <!-- 插槽区域 -->
            <Grid>
                <local:CanvasItemsControl ItemsSource="{Binding Slots}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <Canvas />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <local:CanvasItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="viewmodels:SlotViewModel">
                            <local:SlotView 
                                Width="{x:Bind Size.Width}"
                                Height="{x:Bind Size.Height}"
                                IsEnabled="{x:Bind IsEnabled}"
                                Canvas.Left="{Binding Offset.Left}"
                                Canvas.Top="{Binding Offset.Top}"
                                Canvas.ZIndex="{Binding Offset.Layer}">
                            </local:SlotView>
                        </DataTemplate>
                    </local:CanvasItemsControl.ItemTemplate>
                </local:CanvasItemsControl>
            </Grid>
        </Border>
    </Grid>

</UserControl>
